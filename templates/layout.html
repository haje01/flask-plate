{% extends 'barebone.html' %}

{% macro menu_item(name, active) %}
<li {% if name == active %}class="active"{% endif %}><a
    href="/{{name}}">{{name|title}}</a></li>
{% endmacro %}

{% block navbar %}
<div class="navbar navbar-fixed-top" id="page-top">
  <div class="navbar-inner">
    <div class="container">
      <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
      </button>
      <a class="brand" href="/">{{NAME}}{% if DEV %} [Dev]{% endif %}</a>
      <div class="nav-collapse collapse">
        <ul class="nav">
          {{ menu_item('home', active) }}
          {{ menu_item('about', active) }}
        </ul>
        {% if name %}
          <form class="navbar-form pull-right">
            <label>Welcome, <b>{{name}}</b></label>
          </form>
        {% else %}
          <form id="loginForm" class="navbar-form pull-right" method="post" action="/home">
            <input id="email" name="email" class="span2" type="text" placeholder="Email" {%if email%}value="{{email}}"{%endif%}>
            <input id="passwd" name="passwd" class="span2" type="password" placeholder="Password">
            <button type="submit" class="btn">Sign in</button>
          </form>
        {% endif %}
      </div><!--/.nav-collapse -->                                                                                </div>
  </div>                                                                                                      </div>
{% endblock %}

{% block layoutcss %}
<style>
.show-mobile-nav {
    height: auto;
}
</style>
{% endblock %}

{% block layoutscript %}
<script src="/external/jquery-1.9.1.min.js"></script>
<script src="/external/bootstrap-2.3.1/js/bootstrap.js"></script>
<script src="/external/bootstrap-2.3.1/js/bootstrap-popover.js"></script>
<script>
$(document).ready(function() {
{% if email %}
  $('#passwd').focus();
{% else %}
  $('#email').focus();
{% endif %}
});

function checkRequestLogin(e) {
  if (e && e.keyCode == 13) {
    requestLogin();
    return false;
  }
}

function requestLogin() {
  $.ajax({
    type: 'POST',
    url: '/login',
    data: $('#loginForm').serialize(),
    success: function(data) {
      alert('asdf');
    }
  });
}
</script>

{% block pagescript %}
{% endblock %}

{% endblock %}
